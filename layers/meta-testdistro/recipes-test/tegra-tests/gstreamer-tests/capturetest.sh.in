#!/bin/sh

. @DATADIR@/gstreamer-tests/confvars

if [ ! -e /dev/video0 ]; then
    echo "ERR: no camera found" >&2
    exit 1
fi

if v4l2-ctl --info 2>/dev/null | grep -q uvcvideo 2>/dev/null; then
    gst-launch-1.0 v4l2src num-buffers=300 ! 'video/x-raw,format=(string)YUY2,width=640,height=480,framerate=(fraction)30/1' ! \
		   nvvidconv ! 'video/x-raw(memory:NVMM),format=(string)NV12' ! nvegltransform ! queue ! $VIDEOSINK
else
    gst-launch-1.0 nvarguscamerasrc timeout=10 ! 'video/x-raw(memory:NVMM),width=640,height=480,format=(string)NV12,framerate=(fraction)30/1' ! \
		   nvvidconv ! queue ! $VIDEOSINK
fi
